<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>    
        <!-- bootstrap框架的CDN文件 -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">       
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script> 
        <!-- 调用外部css文件 -->
        <link rel="stylesheet" type="text/css" href="./register.css" />    
        <script src="./common.js"></script>               <!--调用外部javascript文件 -->
        
        <!--<base target="_blank">                          点击所有网页链接均在新窗口打开   <form action = "register.php" method = "post"></form>-->

        <title>Jan's website</title>                    <!-- 网络名字 -->
    </head>
    <body>
        <form action = "/Library/WebServer/Documents/register.php" mathod = "post">
            <div class = "registerFrame">
                <div class = "frame">
                    <lable class = "lableframe"  palceholder = "user name">user name</lable>
                    <input type = "text" id = "uname" class = "inputframe">    
                    <span id = "uname-show"></span>           
                </div>

                <div class = "frame">
                    <lable class = "lableframe"  palceholder = "password">password</lable>
                    <input type = "password" id = "upwd" class = "inputframe">               
                </div>

                <div class = "frame">
                    <lable class = "lableframe"  palceholder = "comfirmpassword">comfirmpassword</lable>
                    <input type = "password" id = "cpwd" class = "inputframe">       
                    <span id = "pwd-show"></span>        
                </div>

                <div class = "frame">
                    <lable class = "lableframe"  palceholder = "email">E-mail</lable>
                    <input type = "email" name = "email" id = "email" class = "inputframe">  

                </div>

                <input type = "submit" value = "register" style = "font-size:25px;">
                                    
            </div>   
        </form> 
        <script src="./common.js"></script>               <!--调用外部javascript文件 -->
        <script>   
            //完成用户名的重复性验证（异步，检查数据库中是否已存在当前用户名）
            function check_name(){
                //创建xhr对象，调用common.js中函数
                var xhr = creatXhr();
                //创建请求
                var uname =$("uname").value;       //获取输入框中的值。         
                //将用户名传到后端在查询
                var url = "/Library/WebServer/Documents/check-name.php?uname=" + uname;  
                //用get方法去数据库查询用户名称看是否已存在。查询用get，向服务器提交数据用post
                xhr.open("get",url,true);
                //设置回调函数，监听状态
                xhr.onreadystatechange = function(){
                    //判断状态，xhr请求状态为4，表示接收响应数据成功，status为200表示服务器已经正确处理请求以及给出响应
                    if(xhr.readyState == 4 && xhr.status == 200) {
                        //提示内容
                        $("uname-show").innerHTML = xhr.responseText;
                    }
                }
                //发送请求
                xhr.send(null);
            }
            //判断两次密码是否一致
            function check_pwd(){
                //获取两个密码框的值，$(id)获取id值，函数在common.js中
                var upwd = $("upwd").value;
                var cpwd = $("cpwd").value;
                //判断是否相等，且密码不为空
                if(upwd == cpwd && upwd !=""){
                    //提示到span中
                    $("pwd-show").innerHTML = "pass";
                }else {
                    $("pwd-show").innerHTML = "password is not match";
                }
            } 
        </script>
    </body>
</html>